{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "g_epf_overlay_v0",
  "type": "object",
  "additionalProperties": false,
  "required": ["version", "created_at", "source", "summary", "panels"],
  "properties": {
    "version": {
      "type": "string",
      "const": "g_epf_overlay_v0"
    },
    "created_at": {
      "type": "string",
      "format": "date-time"
    },
    "source": {
      "type": "string"
    },
    "summary": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "num_runs",
        "num_panels",
        "num_gates",
        "num_failed_gates"
      ],
      "properties": {
        "num_runs": {
          "type": "integer",
          "minimum": 0
        },
        "num_panels": {
          "type": "integer",
          "minimum": 0
        },
        "num_gates": {
          "type": "integer",
          "minimum": 0
        },
        "num_failed_gates": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "g_field": {
      "type": "object",
      "description": "Optional G-field diagnostics attached to this EPF overlay.",
      "additionalProperties": true
    },
    "diagnostics": {
      "type": "object",
      "description": "Optional EPF-specific diagnostics (e.g. paradox_gate_ids).",
      "additionalProperties": true
    },
    "panels": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "panel_id",
          "label",
          "suite",
          "num_traces",
          "num_gates",
          "num_failed_gates",
          "status",
          "notes"
        ],
        "properties": {
          "panel_id": { "type": "string" },
          "label": { "type": "string" },
          "suite": { "type": "string" },
          "num_traces": { "type": "integer", "minimum": 0 },
          "num_gates": { "type": "integer", "minimum": 0 },
          "num_failed_gates": { "type": "integer", "minimum": 0 },
          "status": { "type": "string" },
          "notes": { "type": "string" }
        }
      }
    }
  }
}
