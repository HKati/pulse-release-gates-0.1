# Topology v0 + Decision Engine v0 — Quickstart

This document shows how to run the Topology v0 overlays end-to-end on top of an
existing PULSE status artefact:

- `pulse_paradox_atoms_v0.py` → `paradox_field_v0.json`  
- `pulse_stability_map_demo_v0.py` → `stability_map_v0_demo.json` (demo)  
- `pulse_decision_engine_v0.py` → `decision_engine_v0.json`

All of these are **diagnostic overlays**. They do **not** change core PULSE
gating or CI behaviour; `check_gates.py` remains the source of truth.

---

## 1. Inputs

You need at least one `status.json` artefact produced by the safe pack, e.g.:

- `PULSE_safe_pack_v0/artifacts/status.json`  
  (or any status artefact generated by `tools/run_all.py` / CI).

From this point on, we only **read** that artefact.

---

## 2. Step 1 — Mine paradox atoms (paradox_field_v0)

Run the paradox atom tool on a directory that contains your status artefacts,
and choose an output path for the paradox field:

```bash
python PULSE_safe_pack_v0/tools/pulse_paradox_atoms_v0.py ^
  --status-dir PULSE_safe_pack_v0/artifacts ^
  --output PULSE_safe_pack_v0/artifacts/paradox_field_v0.json ^
  --max-atom-size 4


(Powershell/cmd friendly: use ^ for line breaks, or put everything on one line.)

This produces a paradox_field_v0.json with structure:

{
  "paradox_field_v0": {
    "version": "PULSE_paradox_field_v0",
    "generated_at_utc": "...",
    "source": { ... },
    "atoms": [
      {
        "atom_id": "atom_0000",
        "gates": ["quality.q3_fairness_ok", "slo.q4_slo_ok"],
        "minimal": true,
        "severity": 0.9
      }
    ]
  }
}


atoms[] are paradox atoms (local MUS over gates).

severity is a simple [0,1] score for how “hard” the paradox is.

python PULSE_safe_pack_v0/tools/pulse_stability_map_demo_v0.py ^
  --output PULSE_safe_pack_v0/artifacts/stability_map_v0_demo.json


This writes a synthetic artefact:

{
  "stability_map_v0": {
    "version": "PULSE_stability_map_v0_demo",
    "generated_at_utc": "...",
    "cells": [
      {
        "id": "cell_fairness_slo_epf_demo",
        "profile": "prod_v_demo",
        "dataset_snapshot": "logs_demo_2025Q1",
        "axes": { ... },
        "runs": { ... },
        "gates": { ... },
        "delta_bend": 1,
        "tags": ["topology_demo_v0", "fairness_vs_slo", "epf_interaction"]
      }
    ]
  }
}



delta_bend is a simple Δ-curvature signal for that 2×2 cell.

tags can be used by dashboards to group / filter cells.



4. Step 3 — Run Decision Engine v0

Now combine the core status artefact with the Topology v0 overlays:

python PULSE_safe_pack_v0/tools/pulse_decision_engine_v0.py ^
  --status PULSE_safe_pack_v0/artifacts/status.json ^
  --stability-map PULSE_safe_pack_v0/artifacts/stability_map_v0_demo.json ^
  --paradox-field PULSE_safe_pack_v0/artifacts/paradox_field_v0.json ^
  --output PULSE_safe_pack_v0/artifacts/decision_engine_v0.json


--stability-map and --paradox-field are optional; you can omit them if
the overlays are not available yet.

The output has the form:

{
  "decision_engine_v0": {
    "version": "PULSE_decision_engine_v0",
    "generated_at_utc": "...",
    "inputs": {
      "status_path": "PULSE_safe_pack_v0/artifacts/status.json",
      "stability_map_path": "PULSE_safe_pack_v0/artifacts/stability_map_v0_demo.json",
      "paradox_field_path": "PULSE_safe_pack_v0/artifacts/paradox_field_v0.json"
    },
    "release_state": "PROD_OK",
    "stability_type": "unstably_good",
    "status_summary": {
      "gate_count": 42,
      "failed_gates": [ ... ],
      "passed_gates": [ ... ],
      "rdsi": 0.94
    },
    "stability_summary": {
      "cell_count": 1,
      "delta_bend_max": 1.0
    },
    "paradox_summary": {
      "atom_count": 3,
      "severe_atom_count": 1
    }
  }
}


5. Interpreting release_state and stability_type

Decision Engine v0 does not change CI; it only labels what you already
have:

release_state (heuristic, based on gate failures):

PROD_OK – no failed gates,

STAGE_ONLY – only a small fraction of gates fail,

BLOCK – many gates fail,

UNKNOWN – no gates found.

stability_type (Topology v0 signal + release_state):

stable_good / unstably_good – release_state is “good”,

stable_bad / unstably_bad – release_state is “bad”,

boundary / boundary_simple – “stage-only / frontier” region,

unknown – not enough information.

Intuition:

If release_state = PROD_OK and Topology v0 sees non-trivial curvature
or paradox atoms (delta_bend_max > 0 or atom_count > 0), we label it
as unstably_good: “green, but on a curved/frontier region”.

If there is no topology signal, the same region is stable_good.

6. CI and safety model

All of the above is:

opt-in tooling,

read-only on existing artefacts,

and safe to run locally or in a separate CI job.

The core PULSE contract remains:

gating decisions = status.json + check_gates.py + CI configuration,

Topology v0 and Decision Engine v0 = “field view” and governance overlay
on top of those decisions.

